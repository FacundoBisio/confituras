const translations = {
    es: {
        home: "mermeladas palmelita",
        products: "productos",
        our_products: "Nuestros Productos",
        about: "nosotros",
        contact: "contacto",
        news: "noticias",
        hero_title: "Maestros Confiteros",
        hero_subtitle: "Islas Canarias - Desde 1968",
        splash_welcome: "Bienvenidos",
        enter_site: "Entrar",
        intro_title: "Tradición y Sabor",
        intro_text: "Elaboramos nuestras mermeladas seleccionando las mejores frutas frescas de Canarias. Sin conservantes ni colorantes, solo fruta y azúcar para conseguir un sabor auténtico.",
        prod_kiwi: "Kiwi",
        prod_papaya_orange: "Papaya y Naranja",
        prod_papaya_orange_diet: "Papaya y Naranja (Diet)",
        prod_mango: "Mango",
        prod_guayaba: "Guayaba",
        prod_pina: "Piña",
        prod_fresa: "Fresa",
        prod_naranja: "Naranja",
        prod_pimiento: "Pimiento",
        prod_limon: "Limón",
        // Product Descriptions
        desc_papaya_orange: "Mermelada Extra de Papaya y Naranja 335 g",
        desc_papaya_orange_diet: "Mermelada Extra de Papaya y Naranja - Diet 335 g",
        desc_mango: "Mermelada Extra de Mango 335 g",
        desc_kiwi: "Mermelada Extra de Kiwi 335 g",
        desc_guayaba: "Mermelada Extra de Guayaba 335 g",
        desc_pina: "Mermelada Extra de Piña 335 g",
        desc_fresa: "Mermelada Extra de Fresa 335 g",
        desc_naranja: "Mermelada Extra de Naranja 335 g",
        desc_pimiento: "Mermelada Extra de Pimiento 335 g",
        desc_limon: "Mermelada Extra de Limón 335 g",

        // Footer
        footer_contact: "Contacto",
        footer_distributors: "Distribuidores - Profesionales",
        footer_legal: "Aviso Legal",
        footer_copyright: "© 2026 Palmelitas Jams / Sitios recomendados jam.palmelita.com",
        // Contact Page
        contact_title: "¡Ponte en contacto con nosotros rellenando el formulario!",
        contact_email: "E-MAIL DE CONTACTO",
        contact_name: "NOMBRE",
        contact_message: "COMENTARIO",
        contact_submit: "ENVIAR",
        // News Page Items
        news_1_title: "Palmelita seleccionada como producto local para Madrid Fusión 2023",
        news_1_meta: "Diario de Avisos",
        news_1_date: "Miércoles, 18 de enero de 2023",
        news_1_excerpt: "La gastronomía de Candelaria estará presente en Madrid Fusión...",
        news_2_title: "Palmelita seleccionada para Gran Feria de Alimentación de España El Corte Inglés",
        news_2_meta: "Diario Crítico, Salud y Consumo",
        news_2_date: "Miércoles, 04 de marzo de 2022",
        news_2_excerpt: "El Corte Inglés inaugura la Gran Feria de la Alimentación en el marco de su 75 Aniversario...",
        news_3_title: "«De Bajamar al corazón de Europa»",
        news_3_meta: "Diario de Avisos",
        news_3_date: "Domingo, 21 de junio de 2015",
        news_3_excerpt: "Confituras Palmelita da el salto a Alemania con unos productos de gran calidad...",
        news_4_title: "«Palmelita comienza a exportar sus confituras a Alemania»",
        news_4_meta: "La Opinión de Tenerife",
        news_4_date: "Viernes, 19 de junio de 2015",
        news_4_excerpt: "...Confituras Palmelita fue creada en 1968 por el maestro pastelero Werner Bittermann (1928-2014) en su pequeño obrador...",
        cofinance_text: "Proyecto cofinanciado por el Fondo Europeo de Desarrollo Regional (FEDER)"
    },
    en: {
        home: "palmelita jam",
        products: "products",
        our_products: "Our Products",
        about: "about us",
        contact: "contact",
        news: "news",
        hero_title: "Master Confectioners",
        hero_subtitle: "Canary Islands - Since 1968",
        splash_welcome: "Welcome",
        enter_site: "Enter",
        intro_title: "Tradition and Flavor",
        intro_text: "We make our jams selecting the best fresh fruits from the Canary Islands. No preservatives or colorings, just fruit and sugar to achieve an authentic taste.",
        prod_kiwi: "Kiwi",
        prod_papaya_orange: "Papaya & Orange",
        prod_papaya_orange_diet: "Papaya & Orange (Diet)",
        prod_mango: "Mango",
        prod_guayaba: "Guava",
        prod_pina: "Pineapple",
        prod_fresa: "Strawberry",
        prod_naranja: "Orange",
        prod_pimiento: "Pepper",
        prod_limon: "Lemon",
        // Product Descriptions
        desc_papaya_orange: "Extra Jam Palmelita - Pawpaw - Orange 335 g",
        desc_papaya_orange_diet: "Extra Jam Palmelita - Pawpaw - Orange - Diet 335 g",
        desc_mango: "Extra Jam Palmelita - Mango 335 g",
        desc_kiwi: "Extra Jam Palmelita - Kiwi 335 g",
        desc_guayaba: "Extra Jam Palmelita - Guava 335 g",
        desc_pina: "Extra Jam Palmelita - Pineapple 335 g",
        desc_fresa: "Extra Jam Palmelita - Strawberry 335 g",
        desc_naranja: "Extra Jam Palmelita - Orange 335 g",
        desc_pimiento: "Extra Jam Palmelita - Pepper 335 g",
        desc_limon: "Extra Jam Palmelita - Lemon 335 g",

        // Footer
        footer_contact: "Contact",
        footer_distributors: "Distributors - Professionals",
        footer_legal: "Legal Conditions",
        footer_copyright: "© 2026 Palmelitas Jams / Recommended sites jam.palmelita.com",
        // Contact Page
        contact_title: "Get in touch with us by filling out the form!",
        contact_email: "CONTACT E-MAIL",
        contact_name: "NAME",
        contact_message: "COMMENT",
        contact_submit: "SEND",
        // News Page Items
        news_1_title: "Palmelita selected as local product for Madrid Fusión 2023",
        news_1_meta: "Diario de Avisos",
        news_1_date: "Wednesday, January 18, 2023",
        news_1_excerpt: "The gastronomy of Candelaria will be present at Madrid Fusión...",
        news_2_title: "Palmelita selected for Great Spanish Food Fair El Corte Inglés",
        news_2_meta: "Diario Crítico, Health and Consumption",
        news_2_date: "Wednesday, March 04, 2022",
        news_2_excerpt: "El Corte Inglés inaugurates the Great Food Fair within the framework of its 75th Anniversary...",
        news_3_title: "«From Bajamar to the heart of Europe»",
        news_3_meta: "Diario de Avisos",
        news_3_date: "Sunday, June 21, 2015",
        news_3_excerpt: "Confituras Palmelita takes the leap to Germany with high quality products...",
        news_4_title: "«Palmelita starts exporting its jams to Germany»",
        news_4_meta: "La Opinión de Tenerife",
        news_4_date: "Friday, June 19, 2015",
        news_4_excerpt: "...Confituras Palmelita was created in 1968 by master confectioner Werner Bittermann (1928-2014) in his small workshop...",
        cofinance_text: "Project co-financed by the European Regional Development Fund (ERDF)"
    },
    fr: {
        home: "confiseries palmelita",
        products: "produits",
        our_products: "Nos Produits",
        about: "à propos",
        contact: "contact",
        news: "actualités",
        hero_title: "Maîtres Confiseurs",
        hero_subtitle: "Îles Canaries - Depuis 1968",
        splash_welcome: "Bienvenue",
        enter_site: "Entrer",
        intro_title: "Tradition et Saveur",
        intro_text: "Nous élaborons nos confitures en sélectionnant les meilleurs fruits frais des Canaries. Sans conservateurs ni colorants, juste des fruits et du sucre pour obtenir un goût authentique.",
        prod_kiwi: "Kiwi",
        prod_papaya_orange: "Papaye et Orange",
        prod_papaya_orange_diet: "Papaye et Orange (Diète)",
        prod_mango: "Mangue",
        prod_guayaba: "Goyave",
        prod_pina: "Ananas",
        prod_fresa: "Fraise",
        prod_naranja: "Orange",
        prod_pimiento: "Poivron",
        prod_limon: "Citron",
        // Product Descriptions
        desc_papaya_orange: "Confiture Extra Palmelita - Papaye - Orange 335 g",
        desc_papaya_orange_diet: "Confiture Extra Palmelita - Papaye - Orange - Diète 335 g",
        desc_mango: "Confiture Extra Palmelita - Mangue 335 g",
        desc_kiwi: "Confiture Extra Palmelita - Kiwi 335 g",
        desc_guayaba: "Confiture Extra Palmelita - Goyave 335 g",
        desc_pina: "Confiture Extra Palmelita - Ananas 335 g",
        desc_fresa: "Confiture Extra Palmelita - Fraise 335 g",
        desc_naranja: "Confiture Extra Palmelita - Orange 335 g",
        desc_pimiento: "Confiture Extra Palmelita - Poivron 335 g",
        desc_limon: "Confiture Extra Palmelita - Citron 335 g",

        // Footer
        footer_contact: "Contact",
        footer_distributors: "Distributeurs - Professionnels",
        footer_legal: "Mentions Légales",
        footer_copyright: "© 2026 Palmelitas Jams / Sites recommandés jam.palmelita.com",
        // Contact Page
        contact_title: "Contactez-nous en remplissant le formulaire !",
        contact_email: "E-MAIL DE CONTACT",
        contact_name: "NOM",
        contact_message: "COMMENTAIRE",
        contact_submit: "ENVOYER",
        // News Page Items
        news_1_title: "Palmelita sélectionnée comme produit local pour Madrid Fusión 2023",
        news_1_meta: "Diario de Avisos",
        news_1_date: "Mercredi 18 janvier 2023",
        news_1_excerpt: "La gastronomie de Candelaria sera présente à Madrid Fusión...",
        news_2_title: "Palmelita sélectionnée pour la Grande Foire Alimentaire d'Espagne El Corte Inglés",
        news_2_meta: "Diario Crítico, Santé et Consommation",
        news_2_date: "Mercredi 04 mars 2022",
        news_2_excerpt: "El Corte Inglés inaugure la Grande Foire Alimentaire dans le cadre de son 75e anniversaire...",
        news_3_title: "« De Bajamar au cœur de l'Europe »",
        news_3_meta: "Diario de Avisos",
        news_3_date: "Dimanche 21 juin 2015",
        news_3_excerpt: "Confituras Palmelita fait le saut en Allemagne avec des produits de grande qualité...",
        news_4_title: "« Palmelita commence à exporter ses confitures en Allemagne »",
        news_4_meta: "La Opinión de Tenerife",
        news_4_date: "Vendredi 19 juin 2015",
        news_4_excerpt: "...Confituras Palmelita a été créée en 1968 par le maître confiseur Werner Bittermann (1928-2014) dans son petit atelier...",
        cofinance_text: "Projet cofinancé par le Fonds Européen de Développement Régional (FEDER)"
    },
    de: {
        home: "palmelita konfitüren",
        products: "produkte",
        our_products: "Unsere Produkte",
        about: "über uns",
        contact: "kontakt",
        news: "neuigkeiten",
        hero_title: "Meisterkonditoren",
        hero_subtitle: "Kanarische Inseln - Seit 1968",
        splash_welcome: "Willkommen",
        enter_site: "Eintreten",
        intro_title: "Tradition und Geschmack",
        intro_text: "Wir stellen unsere Konfitüren her, indem wir die besten frischen Früchte der Kanarischen Inseln auswählen. Ohne Konservierungs- oder Farbstoffe, nur Frucht und Zucker für einen authentischen Geschmack.",
        prod_kiwi: "Kiwi",
        prod_papaya_orange: "Papaya und Orange",
        prod_papaya_orange_diet: "Papaya und Orange (Diät)",
        prod_mango: "Mango",
        prod_guayaba: "Guave",
        prod_pina: "Ananas",
        prod_fresa: "Erdbeere",
        prod_naranja: "Orange",
        prod_pimiento: "Paprika",
        prod_limon: "Zitrone",
        // Product Descriptions
        desc_papaya_orange: "Extra Konfitüre Palmelita - Papaya - Orange 335 g",
        desc_papaya_orange_diet: "Extra Konfitüre Palmelita - Papaya - Orange - Diät 335 g",
        desc_mango: "Extra Konfitüre Palmelita - Mango 335 g",
        desc_kiwi: "Extra Konfitüre Palmelita - Kiwi 335 g",
        desc_guayaba: "Extra Konfitüre Palmelita - Guave 335 g",
        desc_pina: "Extra Konfitüre Palmelita - Ananas 335 g",
        desc_fresa: "Extra Konfitüre Palmelita - Erdbeere 335 g",
        desc_naranja: "Extra Konfitüre Palmelita - Orange 335 g",
        desc_pimiento: "Extra Konfitüre Palmelita - Paprika 335 g",
        desc_limon: "Extra Konfitüre Palmelita - Zitrone 335 g",

        // Footer
        footer_contact: "Kontakt",
        footer_distributors: "Händler - Fachleute",
        footer_legal: "Rechtliche Hinweise",
        footer_copyright: "© 2026 Palmelitas Jams / Empfohlene Seiten jam.palmelita.com",
        // Contact Page
        contact_title: "Kontaktieren Sie uns über das Formular!",
        contact_email: "KONTAKT E-MAIL",
        contact_name: "NAME",
        contact_message: "KOMMENTAR",
        contact_submit: "SENDEN",
        // News Page Items
        news_1_title: "Palmelita als lokales Produkt für Madrid Fusión 2023 ausgewählt",
        news_1_meta: "Diario de Avisos",
        news_1_date: "Mittwoch, 18. Januar 2023",
        news_1_excerpt: "Die Gastronomie von Candelaria wird auf der Madrid Fusión präsent sein...",
        news_2_title: "Palmelita für die Große Spanische Lebensmittelmesse El Corte Inglés ausgewählt",
        news_2_meta: "Diario Crítico, Gesundheit und Verbrauch",
        news_2_date: "Mittwoch, 04. März 2022",
        news_2_excerpt: "El Corte Inglés eröffnet die Große Lebensmittelmesse im Rahmen seines 75-jährigen Jubiläums...",
        news_3_title: "« Von Bajamar ins Herz Europas »",
        news_3_meta: "Diario de Avisos",
        news_3_date: "Sonntag, 21. Juni 2015",
        news_3_excerpt: "Confituras Palmelita wagt den Sprung nach Deutschland mit hochwertigen Produkten...",
        news_4_title: "« Palmelita beginnt mit dem Export ihrer Konfitüren nach Deutschland »",
        news_4_meta: "La Opinión de Tenerife",
        news_4_date: "Freitag, 19. Juni 2015",
        news_4_excerpt: "...Confituras Palmelita wurde 1968 von Konditormeister Werner Bittermann (1928-2014) in seiner kleinen Werkstatt gegründet...",
        cofinance_text: "Projekt kofinanziert durch den Europäischen Fonds für regionale Entwicklung (EFRE)"
    }
};

document.addEventListener("DOMContentLoaded", () => {
    const langBtns = document.querySelectorAll(".lang-btn");
    const currentLang = localStorage.getItem("palmelita_lang") || "es"; // Persist language preference

    langBtns.forEach((btn) => {
        btn.addEventListener("click", () => {
            const lang = btn.id.split("-")[1];
            setLanguage(lang);
            localStorage.setItem("palmelita_lang", lang);
            updateActiveButton(lang);
        });
    });

    // Init Language
    setLanguage(currentLang);
    updateActiveButton(currentLang);

    function updateActiveButton(lang) {
        langBtns.forEach((b) => b.classList.remove("active"));
        const activeBtn = document.getElementById(`lang-${lang}`);
        if(activeBtn) activeBtn.classList.add("active");
    }

    // Lógica de Lightbox
    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.getElementById("lightbox-img");
    const closeBtn = document.querySelector(".close-lightbox");
    const productImages = document.querySelectorAll(".product-image img");

    // Crear elemento de descripción en el lightbox si no existe
    if (lightbox && !document.getElementById("lightbox-desc")) {
        const descP = document.createElement("p");
        descP.id = "lightbox-desc";
        descP.style.color = "white";
        descP.style.textAlign = "center";
        descP.style.fontSize = "1.2rem";
        descP.style.marginTop = "1rem";
        descP.style.fontFamily = "var(--font-heading)";
        lightbox.appendChild(descP);
    }
    const lightboxDesc = document.getElementById("lightbox-desc");

    productImages.forEach((img) => {
        img.addEventListener("click", () => {
            if (lightbox && lightboxImg) {
                lightbox.style.display = "flex";
                lightbox.style.flexDirection = "column"; // Ensure column layout
                lightboxImg.src = img.src;
                
                // Get description key from data attribute on parent card or image
                const card = img.closest(".product-card");
                if (card) {
                    const titleElement = card.querySelector("h3[data-i18n]");
                    if (titleElement) {
                        const titleKey = titleElement.getAttribute("data-i18n");
                        // Construct the desc key from prod key: prod_x -> desc_x
                        const descKey = titleKey.replace("prod_", "desc_");
                        
                        // Set text based on current language
                        const currentLang = localStorage.getItem("palmelita_lang") || "es";
                        if (translations[currentLang] && translations[currentLang][descKey]) {
                            lightboxDesc.textContent = translations[currentLang][descKey];
                        } else {
                            lightboxDesc.textContent = "";
                        }
                        // Store the key so we can update it if lang changes while lightbox is open
                        lightboxDesc.setAttribute("data-i18n", descKey);
                    }
                }
            }
        });
    });

    if (closeBtn) {
        closeBtn.addEventListener("click", () => {
            lightbox.style.display = "none";
        });
    }

    if (lightbox) {
        lightbox.addEventListener("click", (e) => {
            if (e.target !== lightboxImg && e.target !== lightboxDesc) {
                lightbox.style.display = "none";
            }
        });
    }

    // Menú Hamburguesa
    const hamburger = document.getElementById("hamburger");
    const navLinks = document.getElementById("nav-links");

    if (hamburger && navLinks) {
        hamburger.addEventListener("click", () => {
            navLinks.classList.toggle("active");
            hamburger.classList.toggle("active");
        });
    }

    // Removed Splash/Reveal listeners since feature is removed
});

function setLanguage(lang) {
    const elements = document.querySelectorAll("[data-i18n]");
    elements.forEach((el) => {
        const key = el.getAttribute("data-i18n");
        if (translations[lang] && translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });
}